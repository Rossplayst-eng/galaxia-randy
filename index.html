<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Para Randy üíô</title>

<style>
  html,body{margin:0;height:100%;background:#000;overflow:hidden;font-family:system-ui,-apple-system,Segoe UI,Roboto}
  canvas{display:none}

  /* Pantalla inicial */
  .overlay{
    position:fixed;inset:0;z-index:30;
    display:flex;flex-direction:column;justify-content:center;align-items:center;
    background:#000;color:#fff;text-align:center;padding:0 18px;
  }
  .overlay h1{
    font-size:34px;font-weight:900;letter-spacing:.4px;
    color:#ff7ad6;
    text-shadow:0 0 18px rgba(255,122,214,.6),0 0 46px rgba(255,0,170,.25);
    margin:0 0 14px 0;
  }
  .overlay p{opacity:.85;margin:0 0 26px 0}
  .enter{
    padding:14px 26px;border-radius:999px;border:none;
    background:linear-gradient(45deg,#ff3bbd,#7b4dff);
    color:white;font-size:16px;cursor:pointer;
    box-shadow:0 0 24px rgba(255,0,170,.45);
  }
  .enter:active{transform:scale(.96)}
  .small{margin-top:14px;font-size:12px;opacity:.55}

  /* Stickers flotando */
  #stickers{
    position:fixed;inset:0;
    pointer-events:none;
    overflow:hidden;
    z-index:15;
    display:none; /* se muestra al entrar */
  }
  .sticker{
    position:absolute;
    opacity:.92;
    filter: drop-shadow(0 0 10px rgba(255,90,190,.18));
    animation-name: floatUp;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
    will-change: transform;
  }
  @keyframes floatUp{
    from{transform: translateY(110vh) rotate(0deg);}
    to{transform: translateY(-25vh) rotate(360deg);}
  }

  /* Texto arriba (tipo video) */
  .top{
    position:fixed;top:16px;left:0;right:0;z-index:20;
    display:flex;justify-content:center;pointer-events:none;
    font-size:30px;font-weight:900;
    color:#ff7ad6;
    text-shadow:0 0 18px rgba(255,122,214,.55), 0 0 40px rgba(255,0,170,.25);
    padding:0 14px;text-align:center;
    display:none; /* aparece al entrar */
  }
  .sub{
    position:fixed;top:58px;left:0;right:0;z-index:20;
    display:flex;justify-content:center;pointer-events:none;
    color:rgba(255,255,255,.86);
    text-shadow:0 2px 14px rgba(0,0,0,.85);
    font-size:13px;padding:0 14px;text-align:center;
    display:none; /* aparece al entrar */
  }
</style>
</head>

<body>
  <div class="overlay" id="overlay">
    <h1>Para Randy üíô</h1>
    <p>Te amo hasta el infinito y m√°s all√° ‚ú®</p>
    <button class="enter" onclick="startExperience()">Entrar con m√∫sica üé∂</button>
    <div class="small">Se abrir√° Spotify en otra pesta√±a (iPhone no deja autoplay con sonido).</div>
  </div>

  <div class="top" id="titleTop">Feliz San Valent√≠n ‚ù§Ô∏è</div>
  <div class="sub" id="subTop">Te amo hasta el infinito y m√°s all√° ‚Äî Para Randy üíô‚ú®</div>

  <div id="stickers"></div>
  <canvas id="c"></canvas>

<script>
/* ===== PERSONALIZA AQU√ç ===== */
const TITULO = "Feliz San Valent√≠n ‚ù§Ô∏è";
const NOMBRE = "Randy";
const FRASE  = "Te amo hasta el infinito y m√°s all√°";
const COLOR_GLOW = "#ff3bbd";
const COLOR_TEXT = "#ff7ad6";
const SPOTIFY_LINK = "https://open.spotify.com/track/2plbrEY59IikOBgBGLjaoe";

/* Tu sticker (ya est√° en el repo) */
const STICKER_FILE = "IMG_4079.png";

/* Cu√°ntos stickers flotando */
const STICKER_COUNT = 26;
/* ============================ */

document.getElementById("titleTop").textContent = TITULO;
document.getElementById("subTop").textContent = `${FRASE} ‚Äî Para ${NOMBRE} üíô‚ú®`;

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
let W,H,DPR;

function resize(){
  DPR = Math.max(1, Math.min(2, devicePixelRatio||1));
  W = canvas.width = Math.floor(innerWidth*DPR);
  H = canvas.height = Math.floor(innerHeight*DPR);
  canvas.style.width = innerWidth+"px";
  canvas.style.height = innerHeight+"px";
}
addEventListener("resize", resize); resize();

const rnd=(a,b)=>a+Math.random()*(b-a);

// Efectos
const TRAIL_ALPHA = 0.16;     // estela blur
const ROT_SPEED   = 0.22;     // giro piso lento
const STAR_COUNT  = 1700;
const DUST_COUNT  = 950;
const SQUARE_COUNT= 420;

const stars = Array.from({length: STAR_COUNT}, ()=>({
  x: Math.random(), y: Math.random(), z: Math.random(), s: rnd(0.3,1.9)
}));

const dust = Array.from({length: DUST_COUNT}, ()=>({
  x: Math.random(), y: Math.random(),
  r: rnd(0.6,1.7), a: rnd(0.08,0.35),
  ph: rnd(0,Math.PI*2)
}));

const squares = Array.from({length: SQUARE_COUNT}, ()=>({
  x: Math.random(), y: Math.random(),
  s: rnd(0.8,2.6), a: rnd(0.08,0.22), vy: rnd(0.0006,0.0022)
}));

// Textos del piso
const TEXTOS_PISO = [
  TITULO, `Para ${NOMBRE}`, FRASE,
  "Contigo lo es todo", "Amor eterno", "Eres mi coraz√≥n",
  "Mi cielo üí´", "Mi infinito ‚ôæÔ∏è", "Mi mundo entero üåç",
  "Mi ni√±o üß∏", "Mi chiquito hermoso ü•∫", "Mi rey üëë",
  "Mi todo ü´∂", "Mi desastre fav üòà"
];

// Piso (tiles)
const tile = [];
for(let i=0;i<160;i++){
  tile.push({
    x: rnd(-1.25,1.25),
    z: rnd(0.25,3.2),
    sc: rnd(0.10,0.18),
    txt: TEXTOS_PISO[(Math.random()*TEXTOS_PISO.length)|0],
  });
}

let T = 0;
let started = false;

// Crear stickers flotando
function createFloatingStickers(){
  const container = document.getElementById("stickers");
  container.innerHTML = "";
  for(let i=0;i<STICKER_COUNT;i++){
    const img = document.createElement("img");
    img.src = STICKER_FILE;
    img.className = "sticker";
    img.style.left = (Math.random()*100) + "vw";
    img.style.top  = (Math.random()*100) + "vh";
    img.style.width = (70 + Math.random()*65) + "px";
    img.style.animationDuration = (14 + Math.random()*16) + "s";
    img.style.animationDelay = (-Math.random()*18) + "s";
    container.appendChild(img);
  }
}

function draw(){
  T += 0.012;

  // Trail
  ctx.fillStyle = `rgba(0,0,0,${TRAIL_ALPHA})`;
  ctx.fillRect(0,0,W,H);

  // Nebulosa
  const g = ctx.createRadialGradient(W*0.5,H*0.45,0,W*0.5,H*0.45,Math.max(W,H)*0.92);
  g.addColorStop(0,"rgba(140,40,180,0.11)");
  g.addColorStop(0.42,"rgba(50,70,160,0.06)");
  g.addColorStop(1,"rgba(0,0,0,0)");
  ctx.fillStyle = g;
  ctx.fillRect(0,0,W,H);

  // Polvo estelar
  ctx.save();
  ctx.globalCompositeOperation = "lighter";
  for(const d of dust){
    const tw = (Math.sin(T*2 + d.ph)*0.5+0.5);
    const a = d.a * (0.45 + tw*0.85);
    ctx.globalAlpha = a;
    ctx.fillStyle = "rgba(255,255,255,1)";
    ctx.fillRect(d.x*W, d.y*H, d.r*DPR, d.r*DPR);
  }
  ctx.restore();

  // Estrellas profundidad
  ctx.save();
  ctx.globalAlpha = 0.92;
  for(const st of stars){
    st.z -= 0.0022;
    if(st.z<=0) st.z = 1;
    const x = (st.x-0.5)*(1/st.z)*W + W/2;
    const y = (st.y-0.5)*(1/st.z)*H + H/2;
    const size = st.s*(1/st.z);
    ctx.fillStyle = "rgba(255,255,255,0.85)";
    ctx.fillRect(x,y,size,size);
  }
  ctx.restore();

  // Cuadritos nieve
  ctx.save();
  for(const q of squares){
    q.y += q.vy;
    if(q.y>1.12){ q.y=-0.12; q.x=Math.random(); }
    ctx.globalAlpha = q.a;
    ctx.fillStyle="rgba(255,255,255,1)";
    ctx.fillRect(q.x*W, q.y*H, q.s*DPR, q.s*DPR);
  }
  ctx.restore();

  // Piso rotando
  const cx=W*0.5, cy=H*0.72;
  const yaw = T*ROT_SPEED;
  const fov = 560*DPR;

  for(const it of tile){
    const x0 = it.x, z0 = it.z;

    const xr = x0*Math.cos(yaw) - z0*Math.sin(yaw);
    const zr = x0*Math.sin(yaw) + z0*Math.cos(yaw);

    const depth = zr + 2.25;
    const px = cx + (xr*fov)/(depth*8.5);
    const py = cy + (1.0*fov)/(depth*10.5);

    const scale = (it.sc*fov)/(depth*6.0);
    const alpha = Math.max(0, 1.15 - depth/3.6);

    // glow piso
    ctx.save();
    ctx.globalCompositeOperation = "lighter";
    ctx.globalAlpha = 0.14*alpha;
    ctx.fillStyle = COLOR_GLOW;
    ctx.beginPath();
    ctx.ellipse(px, py+12*DPR, 38*scale, 12*scale, 0, 0, Math.PI*2);
    ctx.fill();
    ctx.restore();

    // texto
    ctx.globalAlpha = 0.80*alpha;
    ctx.font = `${Math.max(10, 18*scale)}px system-ui`;
    ctx.fillStyle = COLOR_TEXT;
    ctx.fillText(it.txt, px - 60*scale, py - 40*scale);
  }

  // Aro brillante rosa
  ctx.save();
  ctx.globalCompositeOperation = "lighter";
  ctx.shadowColor = COLOR_GLOW;
  ctx.shadowBlur = 34*DPR;

  const ringR = Math.min(W,H)*0.15;
  const ringY = H*0.62;

  ctx.strokeStyle = COLOR_GLOW;
  ctx.lineWidth = 10*DPR;
  ctx.beginPath();
  ctx.ellipse(W*0.5, ringY, ringR*1.65, ringR*0.55, 0, 0, Math.PI*2);
  ctx.stroke();

  ctx.globalAlpha = 0.45;
  ctx.lineWidth = 22*DPR;
  ctx.beginPath();
  ctx.ellipse(W*0.5, ringY, ringR*1.35, ringR*0.45, 0, 0, Math.PI*2);
  ctx.stroke();

  ctx.restore();

  requestAnimationFrame(draw);
}

function startExperience(){
  if(started) return;
  started = true;

  document.getElementById("overlay").style.display="none";
  document.getElementById("stickers").style.display="block";
  document.getElementById("titleTop").style.display="flex";
  document.getElementById("subTop").style.display="flex";

  canvas.style.display="block";

  createFloatingStickers();

  // abrir m√∫sica
  window.open(SPOTIFY_LINK, "_blank");

  ctx.fillStyle="rgba(0,0,0,1)";
  ctx.fillRect(0,0,W,H);
  draw();
}
</script>
</body>
</html>
