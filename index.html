<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Para Randy üíô</title>

<style>
  html,body{
    margin:0;height:100%;
    background:#000;overflow:hidden;
    font-family:system-ui,-apple-system,Segoe UI,Roboto;
  }
  canvas{display:block;width:100vw;height:100vh}

  .top{
    position:fixed;top:16px;left:0;right:0;z-index:10;
    display:flex;justify-content:center;pointer-events:none;
    font-size:34px;font-weight:900;color:#ff7ad6;
    text-shadow:0 0 12px rgba(255,122,214,.34), 0 0 26px rgba(255,0,170,.10);
    padding:0 14px;text-align:center;
  }
  .sub{
    position:fixed;top:62px;left:0;right:0;z-index:10;
    display:flex;justify-content:center;pointer-events:none;
    color:rgba(255,255,255,.88);font-size:13px;
    text-shadow:0 2px 14px rgba(0,0,0,.85);
    padding:0 14px;text-align:center;
  }
</style>
</head>

<body>
  <div class="top" id="titleTop">Feliz San Valent√≠n ‚ù§Ô∏è</div>
  <div class="sub" id="subTop">Te amo hasta el infinito y m√°s all√° ‚Äî Para Randy üíô‚ú®</div>
  <canvas id="c"></canvas>

<script>
/* ===== PERSONALIZA AQU√ç ===== */
const TITULO = "Feliz San Valent√≠n ‚ù§Ô∏è";
const SUB    = "Te amo hasta el infinito y m√°s all√° ‚Äî Para Randy üíô‚ú®";
const STICKER_FILE = "IMG_4079.png";

const TEXTOS = [
  "Mi cielo üí´","Mi infinito ‚ôæÔ∏è","Mi mundo entero üåç","Mi ni√±o üß∏",
  "Mi chiquito hermoso ü•∫","Mi rey üëë","Mi todo ü´∂",
  "Hasta el infinito y m√°s all√° ü™ê","Mi desastre fav üòà","Te amo üíô‚ú®"
];
/* ============================ */

document.getElementById("titleTop").textContent = TITULO;
document.getElementById("subTop").textContent = SUB;

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d", { alpha:true });

let W,H,DPR;
function resize(){
  DPR = Math.max(1, Math.min(2, devicePixelRatio||1));
  W = canvas.width  = Math.floor(innerWidth*DPR);
  H = canvas.height = Math.floor(innerHeight*DPR);
}
addEventListener("resize", resize); resize();

const rnd=(a,b)=>a+Math.random()*(b-a);
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));

let t = 0;

// ===== Par√°metros anti-saturaci√≥n =====
const BG_CLEAR_ALPHA = 0.55;     // 1 = borra total; 0.5 = deja un poquito de suavidad sin manchar
const NEBULA_ALPHA   = 0.10;     // nebulosa suave
const RING_ALPHA     = 0.78;     // anillo ne√≥n controlado
const TEXT_ALPHA     = 0.78;     // textos orbitando legibles
const FLOOR_TEXT_ALPHA = 0.70;   // textos en piso legibles
const FLOOR_GLOW_ALPHA = 0.05;   // glow piso m√≠nimo (evita mancha)
const SHADOW_SOFT    = 10;       // blur del planeta/anillo

// ===== Fondo (sin rayas) =====
const STARS = Array.from({length: 820}, ()=>({
  x: Math.random(), y: Math.random(),
  r: rnd(0.6,1.6),
  a: rnd(0.10,0.55),
  ph: rnd(0,Math.PI*2)
}));
const DUST = Array.from({length: 420}, ()=>({
  x: Math.random(), y: Math.random(),
  r: rnd(0.6,1.3),
  a: rnd(0.04,0.16),
  ph: rnd(0,Math.PI*2)
}));

// ===== Sticker =====
const stickerImg = new Image();
stickerImg.src = STICKER_FILE;
let stickerReady = false;
stickerImg.onload = ()=> stickerReady = true;
stickerImg.onerror = ()=> stickerReady = false;

// ===== √ìrbitas =====
const orbitStickers = [];
const orbitTexts = [];
const floatStickers = [];
const floorItems = [];

function rebuild(){
  orbitStickers.length = 0;
  orbitTexts.length = 0;
  floatStickers.length = 0;
  floorItems.length = 0;

  // radios base
  const baseR1 = Math.min(W,H)*0.20;
  const baseR2 = Math.min(W,H)*0.33;

  // Stickers orbitando (menos para que no se amontonen)
  const orbitStickerCount = 10;
  for(let i=0;i<orbitStickerCount;i++){
    orbitStickers.push({
      r: rnd(baseR1, baseR2),
      a: rnd(0,Math.PI*2),
      w: rnd(44,62)*DPR,
      sp: rnd(0.0019,0.0030),   // lento
      tilt: rnd(0.50,0.66)
    });
  }

  // Textos orbitando (uno por texto)
  for(let i=0;i<TEXTOS.length;i++){
    orbitTexts.push({
      text: TEXTOS[i],
      r: rnd(baseR1*1.06, baseR2*1.18),
      a: (i/TEXTOS.length)*Math.PI*2,
      sp: rnd(0.0014,0.0022),
      tilt: rnd(0.50,0.64)
    });
  }

  // Stickers flotando suaves (poquitos)
  const floatCount = 6;
  for(let i=0;i<floatCount;i++){
    floatStickers.push({
      x: rnd(0.10,0.90),
      y: rnd(0.10,0.92),
      w: rnd(36,52)*DPR,
      vy: rnd(0.00012,0.00022),
      vx: rnd(-0.00008,0.00008),
      a: rnd(0,Math.PI*2),
      rs: rnd(-0.0016,0.0016)
    });
  }

  // Piso 3D (POCO para que no se sature)
  const count = 42;
  for(let i=0;i<count;i++){
    floorItems.push({
      x: rnd(-1.20,1.20),
      z: rnd(0.40,3.10),
      txt: TEXTOS[(Math.random()*TEXTOS.length)|0],
      sc: rnd(0.11,0.17)
    });
  }
}
rebuild();
addEventListener("resize", rebuild);

// ===== Dibujos =====
function drawBackground(){
  // limpiar ‚Äúsuave‚Äù sin estelas rosas
  ctx.globalCompositeOperation = "source-over";
  ctx.fillStyle = `rgba(0,0,0,${BG_CLEAR_ALPHA})`;
  ctx.fillRect(0,0,W,H);

  // nebulosa suave
  const g = ctx.createRadialGradient(W*0.5,H*0.55,0,W*0.5,H*0.55,Math.max(W,H)*0.78);
  g.addColorStop(0,`rgba(255,60,190,${NEBULA_ALPHA})`);
  g.addColorStop(0.40,`rgba(130,60,255,${NEBULA_ALPHA*0.65})`);
  g.addColorStop(1,"rgba(0,0,0,0)");
  ctx.fillStyle = g;
  ctx.fillRect(0,0,W,H);

  // polvo
  for(const d of DUST){
    const tw = (Math.sin(t*2 + d.ph)*0.5+0.5);
    const a = d.a*(0.55+tw*0.85);
    ctx.globalAlpha = a;
    ctx.fillStyle = "rgba(255,255,255,1)";
    ctx.fillRect(d.x*W, d.y*H, d.r*DPR, d.r*DPR);
  }
  ctx.globalAlpha = 1;

  // estrellas
  for(const s of STARS){
    const tw = (Math.sin(t*2 + s.ph)*0.5+0.5);
    const a = s.a*(0.35+tw*0.85);
    ctx.globalAlpha = a;
    ctx.fillStyle = "rgba(255,255,255,1)";
    ctx.fillRect(s.x*W, s.y*H, s.r*DPR, s.r*DPR);
  }
  ctx.globalAlpha = 1;
}

function drawFloor3D(cx,cy){
  // NO usar lighter aqu√≠ (anti-saturaci√≥n)
  ctx.globalCompositeOperation = "source-over";

  const yaw = t*0.20;      // giro lento
  const fov = 610*DPR;

  for(const it of floorItems){
    const x0 = it.x, z0 = it.z;

    // rotaci√≥n (x,z)
    const xr = x0*Math.cos(yaw) - z0*Math.sin(yaw);
    const zr = x0*Math.sin(yaw) + z0*Math.cos(yaw);

    const depth = zr + 2.25;
    const px = cx + (xr*fov)/(depth*8.7);
    const py = cy + (1.0*fov)/(depth*10.2);
    const scale = (it.sc*fov)/(depth*6.2);
    const alpha = Math.max(0, 1.02 - depth/3.35);

    // glow m√≠nimo (para no manchar)
    ctx.globalAlpha = FLOOR_GLOW_ALPHA*alpha;
    ctx.fillStyle = "rgba(255,60,190,1)";
    ctx.beginPath();
    ctx.ellipse(px, py+12*DPR, 34*scale, 11*scale, 0, 0, Math.PI*2);
    ctx.fill();

    // texto piso
    ctx.globalAlpha = FLOOR_TEXT_ALPHA*alpha;
    ctx.fillStyle = "rgba(255,122,214,0.85)";
    ctx.shadowColor = "rgba(255,60,190,0.22)";
    ctx.shadowBlur = 6*DPR;
    ctx.font = `${Math.max(11, 18*scale)}px system-ui`;
    ctx.fillText(it.txt, px - 70*scale, py - 38*scale);
    ctx.shadowBlur = 0;
  }

  ctx.globalAlpha = 1;
}

function drawPlanetAndRing(cx,cy){
  // Solo el planeta/anillo usa ‚Äúlighter‚Äù, pero controlado
  ctx.save();
  ctx.globalCompositeOperation = "lighter";

  const pr = Math.min(W,H)*0.085;
  const ringRot = t*0.35;

  // planeta con blur suave (no quema)
  ctx.shadowColor = "rgba(255,60,190,0.55)";
  ctx.shadowBlur = SHADOW_SOFT*DPR;

  const pg = ctx.createRadialGradient(cx-pr*0.45, cy-pr*0.45, 0, cx, cy, pr*1.45);
  pg.addColorStop(0,"rgba(255,255,255,0.55)");
  pg.addColorStop(0.28,"rgba(255,140,220,0.40)");
  pg.addColorStop(0.72,"rgba(120,70,255,0.35)");
  pg.addColorStop(1,"rgba(0,0,0,0)");

  ctx.fillStyle = pg;
  ctx.globalAlpha = 1;
  ctx.beginPath();
  ctx.arc(cx, cy, pr*1.18, 0, Math.PI*2);
  ctx.fill();

  // anillo (fino + opacidad controlada)
  ctx.shadowBlur = SHADOW_SOFT*DPR;
  ctx.strokeStyle = `rgba(255,60,190,${RING_ALPHA})`;
  ctx.lineWidth = 6*DPR;
  ctx.beginPath();
  ctx.ellipse(cx, cy, pr*2.65, pr*0.98, ringRot, 0, Math.PI*2);
  ctx.stroke();

  ctx.globalAlpha = 0.26;
  ctx.lineWidth = 14*DPR;
  ctx.beginPath();
  ctx.ellipse(cx, cy, pr*2.15, pr*0.78, ringRot, 0, Math.PI*2);
  ctx.stroke();

  ctx.restore();
  ctx.globalAlpha = 1;
}

function drawOrbits(cx,cy){
  // Stickers orbitando
  for(const o of orbitStickers){
    o.a += o.sp;
    const x = cx + Math.cos(o.a)*o.r;
    const y = cy + Math.sin(o.a)*o.r*o.tilt;

    const rot = o.a + t*0.75;
    const w = o.w;

    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(rot);
    ctx.globalAlpha = 0.92;
    if(stickerReady){
      ctx.drawImage(stickerImg, -w/2, -w/2, w, w);
    }else{
      ctx.fillStyle="rgba(255,122,214,0.85)";
      ctx.font = `${Math.max(18, 26*DPR)}px system-ui`;
      ctx.fillText("üíô", -10*DPR, 10*DPR);
    }
    ctx.restore();
  }

  // Textos orbitando (sin manchar)
  ctx.save();
  ctx.globalAlpha = TEXT_ALPHA;
  ctx.fillStyle = "rgba(255,122,214,0.92)";
  ctx.shadowColor = "rgba(255,60,190,0.18)";
  ctx.shadowBlur = 8*DPR;

  for(const tt of orbitTexts){
    tt.a += tt.sp;
    const x = cx + Math.cos(tt.a)*tt.r;
    const y = cy + Math.sin(tt.a)*tt.r*tt.tilt;

    ctx.font = `${Math.max(12, 16*DPR)}px system-ui`;
    ctx.fillText(tt.text, x - 74*DPR, y);
  }
  ctx.restore();
  ctx.globalAlpha = 1;
}

function drawFloatStickers(){
  for(const s of floatStickers){
    s.y += s.vy; s.x += s.vx; s.a += s.rs;

    if(s.y > 1.12) s.y = -0.12;
    if(s.x > 1.12) s.x = -0.12;
    if(s.x < -0.12) s.x = 1.12;

    const x = s.x*W, y = s.y*H, w = s.w;

    ctx.save();
    ctx.translate(x,y);
    ctx.rotate(s.a);
    ctx.globalAlpha = 0.70;
    if(stickerReady){
      ctx.drawImage(stickerImg, -w/2, -w/2, w, w);
    }else{
      ctx.fillStyle="rgba(255,122,214,0.70)";
      ctx.font = `${Math.max(18, 24*DPR)}px system-ui`;
      ctx.fillText("üíô", -10*DPR, 10*DPR);
    }
    ctx.restore();
  }
}

function loop(){
  t += 0.012;

  drawBackground();

  const cx = W/2;
  const cy = H/2 + 60*DPR;

  // Piso 3D (debajo)
  drawFloor3D(cx, cy + 150*DPR);

  // Planeta + anillo
  drawPlanetAndRing(cx, cy);

  // √ìrbita (stickers + textos)
  drawOrbits(cx, cy);

  // Flotantes
  drawFloatStickers();

  requestAnimationFrame(loop);
}

// Arranca siempre (sin m√∫sica, sin overlay)
loop();
</script>
</body>
</html>
